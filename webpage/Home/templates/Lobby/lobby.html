{% block lobby %}
	<div class="lobby"  id="lobby">
		<div class="row align-items-center">
			<div class="col-lg-3 d-flex justify-content-center">
				<!-- sidebar: users connecting to get ready to play -->
				<table class="table-primary" style="color: #F0FFFF; background-color: #178CA8; border: 5px solid #F0FFFF; width: 80%; text-align: center; margin-top: 50px;">
					<thead>
						<tr>
							<th scope="col"></th>
						</tr>
					</thead>
					<tbody>
						<tr class="table-active">
							<td colspan="2" class="table-active" style="font-size: 40px; margin: 30px; text-align: center;">Players</td>
						</tr>
						<tr>
							<!-- add a column to put the fucking img in it so it will be fucking align-->
							<td class="align-right">
								<img src="../../static/img/profile_picTEST.png" alt="player1" width="60" style="border-radius: 50%;">
							</th>
							<td class="align-left" style="color: #f0ffff; font-size: 40px;">player1</td>
								
						</tr>
						<tr>
							<!-- add a column to put the fucking img in it so it will be fucking align-->
							<td class="align-right">
								<img src="../../static/img/profile_picTEST.png" alt="player1" width="60" style="border-radius: 50%;">
							</th>
							<td class="align-right" style="color: #f0ffff; font-size: 40px;">player2</td>
								
						</tr>
						<tr>
							<!-- add a column to put the fucking img in it so it will be fucking align-->
							<td class="align-right">
								<img src="../../static/img/profile_picTEST.png" alt="player1" width="60" style="border-radius: 50%;">
							</th>
							<td class="align-right" style="color: #f0ffff; font-size: 40px;">player3</td>
								
						</tr>
						<tr class="table-active">
							<td colspan="2" class="table-active text-center">
								<button type="button" onclick="on_click_update_players()" class="btn align-items-center" style="background-color: #0E4870; color: #F0FFFF; font-size: 60px; margin: 30px;" id="startEngine">START!</button>
							</td>
						</tr>
						<tr class="table-active">
							<td colspan="2" class="table-active text-center">

								<button class="btn btn-lg custom-spinner" id="custom-spinner" type="button" disabled>
									   <span class="spinner-border spinner-border-sm" style="color: #F0FFFF;" aria-hidden="true"></span>
									   <span role="status" style="color: #F0FFFF;">Loading...</span>
									 </button>
							</td>

						</tr>
					</tbody>
				</table>
			</div>
			<div class="col-lg-9 d-flex flex-column justify-content-center">
				<div id="game-info-container">
					<canvas id="canvas" class="flex-grow-1" style="background-color: #000000; margin-top: 50px; width: 100%; height: 100%; box-sizing: border-box;"></canvas>
					<!-- <canvas id="canvas" width="800" height="600" style="background-color: #000000;"></canvas> -->
					<script>

					const canvas = document.getElementById('canvas');
					const ctx = canvas.getContext('2d');

					// Store the initial dimensions
					const initialWidth = canvas.width;
					const initialHeight = canvas.height;
					
					function setCanvasSize() {
						const parent = canvas.parentElement

						//Use initial dimensions if the parent is smaller
						canvas.width = Math.min(initialWidth, parent.clientWidth);
						canvas.height = Math.min(initialHeight, parent.clientHeight);
						
						ctx.fillStyle = '#000000';
						ctx.fillRect(0, 0, canvas.width, canvas.height);
					}
					
					
					window.addEventListener('resize', setCanvasSize);
					var s1 = 0;
					var s2 = 0;

					var paddle1 = {
						x: canvas.width - 50,
						y: canvas.height / 2 - 25,
						width: 10,
						height: 50,
						color: "#ff6700", // player1 color
						speed: 10
					};
					
					var paddle2 = {
						x: 50,
						y: canvas.height / 2 - 25, // Center the paddle vertically
						width: 10,
						height: 50,
						color: "#23e301", // Player2 color
						speed: 10
					};
					
					var ball = {
						x: canvas.width / 2,
						y: canvas.height / 2,
						radius: 5,
						color: "#0000ff", // Blue color
						speedX: 4,
						speedY: 4
					};

					document.addEventListener("keydown", function (event) {
						//paddle1
						// Move paddle up (keyCode 38 or W key)
						if ((event.keyCode === 38) && paddle1.y > 0) {
							paddle1.y -= paddle1.speed;
						}
						
						// Move paddle down (keyCode 40 or S key)
						if ((event.keyCode === 40 ) && paddle1.y < canvas.height - paddle1.height) {
							paddle1.y += paddle1.speed;
						}

						// Move paddle left (keyCode 37 or A key)
						if ((event.keyCode === 37 ) && paddle1.x > 0) {
							paddle1.x -= paddle1.speed;
						}
						
						// Move paddle right (keyCode 39 or D key)
						if ((event.keyCode === 39 ) && paddle1.x < canvas.width - paddle1.width) {
							paddle1.x += paddle1.speed;
						}
						
						// paddle2
						// Move paddle up (keyCode 38 or W key)
						if (( event.key === 'w') && paddle2.y > 0) {
							paddle2.y -= paddle2.speed;
						}
						
						// Move paddle down (keyCode 40 or S key)
						if (( event.key === 's') && paddle2.y < canvas.height - paddle2.height) {
							paddle2.y += paddle2.speed;
						}
						
						// Move paddle left (keyCode 37 or A key)
						if (( event.key === 'a') && paddle2.x > 0) {
							paddle2.x -= paddle2.speed;
						}
						
						// Move paddle right (keyCode 39 or D key)
						if (( event.key === 'd') && paddle2.x < canvas.width - paddle2.width) {
							paddle2.x += paddle2.speed;
						}
					});

					function update() {
						// Clear the canvas
						ctx.clearRect(0, 0, canvas.width, canvas.height);
						ctx.fillStyle = '#000000';
						ctx.fillRect(0, 0, canvas.width, canvas.height);
						
						// Check for collisions with the paddle
						if (
							ball.x + ball.radius > paddle1.x &&
							ball.x - ball.radius < paddle1.x + paddle1.width &&
							ball.y + ball.radius > paddle1.y &&
							ball.y - ball.radius < paddle1.y + paddle1.height
							) {
								ball.color = "#ff6700"; // Change to green color
						} 
							
							// Check for collisions with the paddle
						if (
							ball.x + ball.radius > paddle2.x &&
							ball.x - ball.radius < paddle2.x + paddle2.width &&
							ball.y + ball.radius > paddle2.y &&
							ball.y - ball.radius < paddle2.y + paddle2.height
							) {
								ball.color = "#23e301"; // Change to green color
						}
									
						// Draw the paddle
						ctx.fillStyle = paddle1.color;
						ctx.fillRect(paddle1.x, paddle1.y, paddle1.width, paddle1.height);
						
						ctx.fillStyle = paddle2.color;
						ctx.fillRect(paddle2.x, paddle2.y, paddle2.width, paddle2.height);
						
						// ctx.font = "42px Arial";
						// ctx.fillStyle = "#ffffff";
						// ctx.fillText(s1, 100, 50);
						// ctx.fillText(s2, 700, 50);

						
						
						// Draw the ball
						ctx.fillStyle = ball.color;
						ctx.beginPath();
						ctx.arc(ball.x, ball.y, ball.radius, 0, 2 * Math.PI);
						ctx.fill();

						
						// Request the next animation frame
						requestAnimationFrame(update);
					}
					setCanvasSize();
					// Start the update loop
					update();
					</script>
				</div>
			</div>
		</div>
	</div>
	
{% endblock %}
